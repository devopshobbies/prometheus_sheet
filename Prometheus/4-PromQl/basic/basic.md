


โ`PromQL` ุฒุจุงู `Query Language` ูุฑุจูุท ุจู `Prometheus` ุงุณุช. ุจุง ุงูฺฉู ุจู QL ุฎุชู ูโุดูุฏุ ูุชูุฌู ุฎูุงูุฏ ุดุฏ ฺฉู ุฒุจุงู ุดุจู `SQL` ูุณุชุ ุฒุฑุง ุฒุจุงูโูุง `SQL` ูุนูููุงู ูุฏุฑุช ุจุงู ฺฉุงู ุจุฑุง ุงูุฌุงู ูุญุงุณุจุงุช ฺฉู ุฑู `time series` (ุณุฑโูุง ุฒูุงู) ุงูุฌุงู ูโุฏูุฏ ุฑุง ูุฏุงุฑูุฏ. `Labels` (ุจุฑฺุณุจโูุง) ุจุฎุด ฺฉูุฏ `PromQL` ูุณุชูุฏ ู ูโุชูุงูุฏ ุงุฒ ุขูโูุง ูู ุชููุง ุจุฑุง ุงูุฌุงู `aggregations` (ุชุฌูุนโูุง) ุฏูุฎูุงูุ ุจูฺฉู ุจุฑุง ูพููุฏ ุฏุงุฏู `metrics` ูุฎุชูู ุจู ฺฉุฏฺฏุฑ ุฌูุช ุงูุฌุงู `arithmetic operations` (ุนููุงุช ุญุณุงุจ) ุฑู ุขูโูุง ุงุณุชูุงุฏู ฺฉูุฏ. ุทู ฺฏุณุชุฑุฏูโุง ุงุฒ ุชูุงุจุน ุงุฒ `prediction` (ูพุดโุจู) ฺฏุฑูุชู ุชุง ุชูุงุจุน `date` (ุชุงุฑุฎ) ู `math functions` (ุฑุงุถ) ุฏุฑ ุฏุณุชุฑุณ ุดูุง ูุณุชูุฏ.

ุงู ุฏุฑุณ ุจู ุดูุง ุฑุง ุจุง ููุงูู ูพุงู `PromQL`ุ ุดุงูู `aggregation` (ุชุฌูุน)ุ `basic types` (ุงููุงุน ูพุงู) ู `HTTP API` ุขุดูุง ูโฺฉูุฏ.

โ`Prometheus` ฺฉ ุฒุจุงู `query` ุชุงุจุน ุจู ูุงู `PromQL` (`Prometheus Query Language`) ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุจู ฺฉุงุฑุจุฑ ุงุฌุงุฒู ูโุฏูุฏ ุฏุงุฏูโูุง `time series` ุฑุง ุฏุฑ ุฒูุงู ูุงูุน ุงูุชุฎุงุจ ู `aggregate` ฺฉูุฏ.

ููุช ฺฉ ุฏุฑุฎูุงุณุช `query` ุจู `Prometheus` ุงุฑุณุงู ูโฺฉูุฏุ ูโุชูุงูุฏ ฺฉ `instant query` ุจุงุดุฏ ฺฉู ุฏุฑ ฺฉ ููุทู ุฒูุงู ุงุฑุฒุงุจ ูโุดูุฏุ ุง ฺฉ `range query` ุฏุฑ ฺฏุงูโูุง ุจุง ูุงุตูู ูุณุงู ุจู ุฒูุงู ุดุฑูุน ู ูพุงุงู. `PromQL` ุฏููุงู ุจู ููู ุดฺฉู ุฏุฑ ูุฑ ุฏู ุญุงูุช ฺฉุงุฑ ูโฺฉูุฏุ `range query` ูุงููุฏ ฺฉ `instant query` ุงุณุช ฺฉู ฺูุฏู ุจุงุฑ ุฏุฑ `timestamp`ูุง ูุฎุชูู ุงุฌุฑุง ูโุดูุฏ.

ุฏุฑ `UI` `Prometheus`ุ ุชุจ `"Table"` ุจุฑุง `instant queries` ู ุชุจ `"Graph"` ุจุฑุง `range queries` ุงุณุช.

ุจุฑูุงููโูุง ุฏฺฏุฑ ูโุชูุงููุฏ ูุชุฌู ฺฉ `expression` `PromQL` ุฑุง ุงุฒ ุทุฑู `HTTP API` ุฏุฑุงูุช ฺฉููุฏ.

**ูุซุงูโูุง**
ุงู ุณูุฏ ฺฉ ูุฑุฌุน ูพุงู ุฒุจุงู `Prometheus` ุงุณุช. ุจุฑุง ุงุฏฺฏุฑุ ููฺฉู ุงุณุช ุดุฑูุน ุจุง ฺูุฏ ูุซุงู ุขุณุงูโุชุฑ ุจุงุดุฏ.

**ุงููุงุน ุฏุงุฏู ุฒุจุงู `Expression`**
ุฏุฑ ุฒุจุงู `expression` `Prometheus`ุ ฺฉ `expression` ุง `sub-expression` ูโุชูุงูุฏ ุจู ฺฉ ุงุฒ ฺูุงุฑ ููุน ุงุฑุฒุงุจ ุดูุฏ:

*   โ`Instant vector` - ูุฌููุนูโุง ุงุฒ `time series` ุญุงู ฺฉ `sample` ุจุฑุง ูุฑ `time series`ุ ฺฉู ููฺฏ `timestamp` ฺฉุณุงู ุฏุงุฑูุฏ.
*   โ`Range vector` - ูุฌููุนูโุง ุงุฒ `time series` ุญุงู ูุญุฏูุฏูโุง ุงุฒ ููุงุท ุฏุงุฏู ุฏุฑ ุทูู ุฒูุงู ุจุฑุง ูุฑ `time series`.
*   โ`Scalar` - ฺฉ ููุฏุงุฑ ุนุฏุฏ ุณุงุฏู `floating point`.
*   โ`String` - ฺฉ ููุฏุงุฑ `string` ุณุงุฏูุ ุฏุฑ ุญุงู ุญุงุถุฑ ุงุณุชูุงุฏู ููโุดูุฏ.



## Instant Vector

ฺฉ `instant vector selector` ฺฉ `instant vector` ุงุฒ ุฌุฏุฏุชุฑู `samples` ูุจู ุงุฒ ุฒูุงู ุงุฑุฒุงุจ ฺฉูุฆุฑ (`query evaluation time`) ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏุ ุนู ูุณุช ุงุฒ ุตูุฑ ุง ฺูุฏ `time series`. ูุฑ ฺฉ ุงุฒ ุงู `time series`ูุง ฺฉ `sample` ุฎูุงููุฏ ุฏุงุดุช ู ฺฉ `sample` ูู ููุฏุงุฑ ู ูู `timestamp` ุฑุง ุฏุฑ ุจุฑ ูโฺฏุฑุฏ. ุฏุฑ ุญุงู ฺฉู `instant vector` ุจุงุฒฺฏุดุช ุชูุณุท ฺฉ `instant vector selector` ุฏุงุฑุง `timestamp` ุฏุงุฏู ุงุตู ุงุณุชุ ูุฑ `instant vector` ุจุงุฒฺฏุดุช ุชูุณุท ุนููุงุช ุง ุชูุงุจุน ุฏฺฏุฑุ `timestamp` ุฒูุงู ุงุฑุฒุงุจ ฺฉูุฆุฑ ุฑุง ุจุฑุง ุชูุงู ููุงุฏุฑ ุฎูุฏ ุฎูุงูุฏ ุฏุงุดุช.

ููฺฏุงู ฺฉู ุงุณุชูุงุฏู ูุนู ุญุงูุธู ุฑุง ุฏุฑุฎูุงุณุช ูโฺฉูุฏุ ููโุฎูุงูุฏ `samples` ุงุฒ ฺฉ `instance` ฺฉู ุฑูุฒูุง ูพุด ุฎุงููุด ุดุฏู ุงุณุชุ ุดุงูู ุดูุฏุ ููููู ฺฉู ุจู ุนููุงู `staleness` (ฺฉููฺฏ) ุดูุงุฎุชู ูโุดูุฏ. ุฏุฑ Prometheus 1.x ุงู ฺฉุงุฑ ุจุง ุจุฑฺฏุฑุฏุงูุฏู `time series`ูุง ุงูุฌุงู ูโุดุฏ ฺฉู `sample` ุขูโูุง ุญุฏุงฺฉุซุฑ ต ุฏููู ูุจู ุงุฒ ุฒูุงู ุงุฑุฒุงุจ ฺฉูุฆุฑ ุจูุฏ. ุงู ุชุง ุญุฏ ุฒุงุฏ ฺฉุงุฑ ูโฺฉุฑุฏ ุงูุง ูุนุงุจ ูุงููุฏ ุดูุงุฑุด ูุถุงุนู ุฏุงุดุช ุงฺฏุฑ ฺฉ `instance` ุจุง `label` `instance` ุฌุฏุฏ ุฏุฑ ุขู ูพูุฌุฑู ต ุฏูููโุง ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ูโุดุฏ.

โPrometheus 2.x ุฑูฺฉุฑุฏ ูพฺุฏูโุชุฑ ุฏุงุฑุฏ. ุงฺฏุฑ ฺฉ `time series` ุงุฒ ฺฉ `scrape` ุจู `scrape` ุจุนุฏ ูุงูพุฏุฏ ุดูุฏุ ุง ุงฺฏุฑ ฺฉ `target` ุฏฺฏุฑ ุงุฒ `service discovery` ุจุงุฒฺฏุฑุฏุงูุฏู ูุดูุฏุ ููุน ุฎุงุต ุงุฒ `sample` ุจู ูุงู `stale marker`ยนโฐ (ูุดุงูฺฏุฑ ฺฉููู) ุจู `time series` ุงุถุงูู ูโุดูุฏ. ููฺฏุงู ุงุฑุฒุงุจ ฺฉ `instant vector selector`ุ ุงุจุชุฏุง ุชูุงู `time series`ูุง ฺฉู ุชูุงู `matchers` ุฑุง ุจุฑุขูุฑุฏู ูโฺฉููุฏ ูพุฏุง ูโุดููุฏ ู ุฌุฏุฏุชุฑู `sample` ุฏุฑ ต ุฏููู ูุจู ุงุฒ ุฒูุงู ุงุฑุฒุงุจ ฺฉูุฆุฑ ููฺูุงู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุงฺฏุฑ `sample` ฺฉ `sample` ูุนููู ุจุงุดุฏุ ุฏุฑ `instant vector` ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏุ ุงูุง ุงฺฏุฑ ฺฉ `stale marker` ุจุงุดุฏุ ุขู `time series` ุฏุฑ ุขู `instant vector` ฺฏูุฌุงูุฏู ูุฎูุงูุฏ ุดุฏ. ูุชุฌู ููู ุงููุง ุงู ุงุณุช ฺฉู ููุช ุงุฒ `instant vector selector` ุงุณุชูุงุฏู ูโฺฉูุฏุ `time series`ูุง ฺฉู `stale` (ฺฉููู) ุดุฏูโุงูุฏุ ุจุงุฒฺฏุฑุฏุงูุฏู ููโุดููุฏ.

ุงฺฏุฑ `exporter` ุง ุฏุงุฑุฏ ฺฉู `timestamps` ุฑุง ููุงุด ูโุฏูุฏุ ููุงูุทูุฑ ฺฉู ุฏุฑ "Timestamps" ุฏุฑ ูุจู ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุชุ `stale markers` ู ููุทู `staleness` Prometheus 2.x ุงุนูุงู ูุฎูุงูุฏ ุดุฏ. `time series`ูุง ุชุญุช ุชุฃุซุฑ ุจู ุฌุง ุขู ุจุง ููุทู ูุฏูโุชุฑ ฺฉู ต ุฏููู ุจู ุนูุจ ูฺฏุงู ูโฺฉูุฏุ ฺฉุงุฑ ุฎูุงููุฏ ฺฉุฑุฏ.


```json
curl 'http://localhost:9090/api/v1/query' \
  --data 'query=http_requests_total{code="200"}' \
  --data time=1608481001
{
  "metric": {"__name__": "http_requests_total", "code": "200"},
  "value": [1608481001, "881"]
}
```

![[instantVec2.png]]



![[instantVector.png]]





### Range Vector

ููุน ุฏูู `selector` ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูุจูุงู ุฏุฏูโุงุฏ ู `range vector selector` ูุงูุฏู ูโุดูุฏ. ุจุฑุฎูุงู `instant vector selector` ฺฉู ฺฉ `sample` ุจุฑุง ูุฑ `time series` ุจุฑูโฺฏุฑุฏุงูุฏุ ฺฉ `range vector selector` ูโุชูุงูุฏ ฺูุฏู `sample` ุจุฑุง ูุฑ `time series` ุจุฑฺฏุฑุฏุงูุฏ.ยนยน `Range vectors` ููุดู ุจุง ุชุงุจุน `rate` ุงุณุชูุงุฏู ูโุดููุฏุ ุจู ุนููุงู ูุซุงู:

`rate(process_cpu_seconds_total[1m])`

โ`[1m]` `instant vector selector` ุฑุง ุจู `range vector selector` ุชุจุฏู ูโฺฉูุฏ ู ุจู `PromQL` ุฏุณุชูุฑ ูโุฏูุฏ ุชุง ุจุฑุง ุชูุงู `time series`ูุง ูุทุงุจู ุจุง `selector`ุ ุชูุงู `samples` ูุฑุจูุท ุจู ุฏููู ููุชู ุจู ุฒูุงู ุงุฑุฒุงุจ ฺฉูุฆุฑ ุฑุง ุจุฑฺฏุฑุฏุงูุฏ. ุงฺฏุฑ ููุท `process_cpu_seconds_total[1m]` ุฑุง ุฏุฑ ุชุจ `Console` ูุฑูุฑฺฏุฑ `expression` ุงุฌุฑุง ฺฉูุฏุ ฺุฒ ุดุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุฏุฏ.

![[pic13.png]]

ุฏุฑ ุงู ููุฑุฏุ ูุฑ `time series` ุงุชูุงูุงู ุดุด `sample` ุฏุฑ ุฏููู ฺฏุฐุดุชู ุฏุงุฑุฏ. ูุชูุฌู ุฎูุงูุฏ ุดุฏ ฺฉู ุฏุฑ ุญุงู ฺฉู `samples` ุจุฑุง ูุฑ `time series` ุงุชูุงูุงู ุฏููุงู ฑฐ ุซุงูู ุงุฒ ูู ูุงุตูู ุฏุงุฑูุฏ ูุทุงุจู ุจุง ูุงุตูู `scrape` ฺฉู ูพฺฉุฑุจูุฏ ฺฉุฑุฏูโุงุฏุ `timestamps` ุฏู `time series` ุจุง ฺฉุฏฺฏุฑ ููโุชุฑุงุฒ ูุณุชูุฏ. ฺฉ `time series` ฺฉ `sample` ุจุง `timestamp` 1517925155.087 ุฏุงุฑุฏ ู ุฏฺฏุฑ 1517925156.245.



ุงู ุจู ุงู ุฏูู ุงุณุช ฺฉู `range vectors` `timestamps` ูุงูุน `samples` ุฑุง ุญูุธ ูโฺฉููุฏ ู `scrapes` ุจุฑุง `targets` ูุฎุชูู ุจู ููุธูุฑ ุชูุฒุน ุจุงุฑ ุจู ุทูุฑ ูุณุงูโุชุฑุ ุชูุฒุน ูโุดููุฏ. ุฏุฑ ุญุงู ฺฉู ูโุชูุงูุฏ ูุฑฺฉุงูุณ `scrapes` ู ุงุฑุฒุงุจ ููุงูู ุฑุง ฺฉูุชุฑู ฺฉูุฏุ ููโุชูุงูุฏ `phase` ุง `alignment` (ุชุฑุงุฒุจูุฏ) ุขูโูุง ุฑุง ฺฉูุชุฑู ฺฉูุฏ. ุงฺฏุฑ ูุงุตูู `scrape` ฑฐ ุซุงููโุง ู ุตุฏูุง `target` ุฏุงุฑุฏุ ุชูุงู ุขู `target`ูุง ุฏุฑ ููุงุท ูุฎุชูู ุฏุฑ ฺฉ ูพูุฌุฑู ฑฐ ุซุงููโุง ูุนู `scrape` ุฎูุงููุฏ ุดุฏ. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ `time series`ูุง ุดูุง ููฺฏ ุณูโูุง ฺฉู ูุชูุงูุช ุฏุงุฑูุฏ. ุงู ุจู ุทูุฑ ฺฉู ุฏุฑ ุนูู ุจุฑุง ุดูุง ุงููุช ูุฎูุงูุฏ ุฏุงุดุชุ ุงูุง ูโุชูุงูุฏ ููุฌุฑ ุจู `artifacts` (ูุตููุนุงุช) ุดูุฏ ุฒุฑุง ุงุณุงุณุงู ุณุณุชูโูุง ูุงูุชูุฑูฺฏ ูุจุชู ุจุฑ `metrics` ูุงููุฏ `Prometheus` ุชุฎููโูุง (ุจุณุงุฑ ุฎูุจ) ุจู ุฌุง ูพุงุณุฎโูุง ุฏูู ุชููุฏ ูโฺฉููุฏ.

ุดูุง ุจู ูุฏุฑุช ุจู ุทูุฑ ูุณุชูู ุจู `range vectors` ูฺฏุงู ุฎูุงูุฏ ฺฉุฑุฏ. ุงู ููุท ุฒูุงู ูพุด ูโุขุฏ ฺฉู ุจุฑุง `debugging` ูุงุฒ ุจู ุฏุฏู `samples` ุฎุงู ุฏุงุฑุฏ. ุชูุฑุจุงู ููุดู ุงุฒ `range vector` ุจุง ุชุงุจุน ูุงููุฏ `rate` ุง `avg_over_time` ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ ฺฉู `range vector` ุฑุง ุจู ุนููุงู ุขุฑฺฏููุงู ูโฺฏุฑุฏ. `Staleness` ู `stale markers` ุชุฃุซุฑ ุจุฑ `range vectors` ูุฏุงุฑูุฏุ ุดูุง ุชูุงู `samples` ูุนููู ุฑุง ุฏุฑ ฺฉ ุจุงุฒู ูุนู ุฏุฑุงูุช ุฎูุงูุฏ ฺฉุฑุฏ. ูุฑ `stale marker` ุฏฺฏุฑ ูุฒ ฺฉู ุฏุฑ ุขู ุจุงุฒู ุจุงุดุฏุ ุชูุณุท `range vector selector` ุจุงุฒฺฏุฑุฏุงูุฏู ููโุดูุฏ.

![[ReangeVec.png]]


![[RangeVector2.png]]



```json
curl 'http://localhost:9090/api/v1/query' \
  --data 'query=http_requests_total{code="200"}[30s]' \
  --data time=1608481001
{
  "metric": {"__name__": "http_requests_total", "code": "200"},
  "values": [
    [1608480978, "863"],
    [1608480986, "874"],
    [1608480094, "881"]
  ]
}
```

ุจุณุชู ุจู ููุฑุฏ ุงุณุชูุงุฏู (ูุซูุงู ููฺฏุงู ุชุฑุณู `graph` ุฏุฑ ููุงุจู ููุงุด ุฎุฑูุฌ ฺฉ `expression`)ุ ููุท ุจุฑุฎ ุงุฒ ุงู ุงููุงุน ุจู ุนููุงู ูุชุฌู ฺฉ `expression` ูุดุฎุต ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ ูุฌุงุฒ ูุณุชูุฏ. ุจุฑุง `instant queries`ุ ูุฑ ฺฉ ุงุฒ ุงููุงุน ุฏุงุฏู ุจุงูุง ุจู ุนููุงู ุฑุดู `expression` ูุฌุงุฒ ุงุณุช. `Range queries` ููุท ุงุฒ `expression`ูุง ููุน `scalar` ู `instant-vector` ูพุดุชุจุงู ูโฺฉููุฏ.

**ุงุฏุฏุงุดุชโูุง ุฏุฑุจุงุฑู `native histograms` ุชุฌุฑุจ:**

*   ูุนุงู ฺฉุฑุฏู `Ingesting` `native histograms` ุจุงุฏ ุงุฒ ุทุฑู ฺฉ `feature flag` ุงูุฌุงู ุดูุฏ.
*   ููฺฏุงู ฺฉู `native histograms` ุฏุฑ `TSDB` `ingest` ุดุฏูุฏ (ู ุญุช ูพุณ ุงุฒ ุบุฑูุนุงู ฺฉุฑุฏู ุฏูุจุงุฑู `feature flag`)ุ ูู `instant vectors` ู ูู `range vectors` ููฺฉู ุงุณุช ุงฺฉููู ุญุงู `sample`ูุง ุจุงุดูุฏ ฺฉู ุงุนุฏุงุฏ ุณุงุฏู `floating point` (`float samples`) ูุณุชูุฏุ ุจูฺฉู `histograms` ฺฉุงูู (`histogram samples`) ูุณุชูุฏ. ฺฉ `vector` ููฺฉู ุงุณุช ุชุฑฺฉุจ ุงุฒ `float samples` ู `histogram samples` ุฑุง ุดุงูู ุดูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงุตุทูุงุญ ยซ`histogram sample`ยป ุฏุฑ ูุณุชูุฏุงุช `PromQL` ููุดู ุจู ฺฉ `native histogram` ุงุดุงุฑู ุฏุงุฑุฏ. `Classic histograms` ุจู ุชุนุฏุงุฏ `series` ุงุฒ `float samples` ุชูุณู ูโุดููุฏ. ุงุฒ ุฏุฏฺฏุงู `PromQL`ุ ฺุฒ ุจู ูุงู ยซ`classic histogram samples`ยป ูุฌูุฏ ูุฏุงุฑุฏ.
*   ูุงููุฏ `float samples`ุ `histogram samples` ูโุชูุงููุฏ `counters` ุง `gauges` ุจุงุดูุฏ ฺฉู ุจู ุชุฑุชุจ `counter histograms` ุง `gauge histograms` ูุฒ ูุงูุฏู ูโุดููุฏ.
*  โ `Native histograms` ูโุชูุงููุฏ `bucket layout`ูุง ูุฎุชูู ุฏุงุดุชู ุจุงุดูุฏุ ุงูุง ุจู ุทูุฑ ฺฉู ุจุฑุง ุงุนูุงู ุนููุงุช `binary` ู `aggregation` ุฑู ุขููุงุ ูุงุจู ุชุจุฏู ุจู ูุณุฎูโูุง ุณุงุฒฺฏุงุฑ ูุณุชูุฏ. ุงู ุจุฑุง ููู `bucketing schemas` ุตุงุฏู ูุณุช. ุงฺฏุฑ `histograms` ูุงุณุงุฒฺฏุงุฑ ุฏุฑ ฺฉ ุนููุงุช ููุงุฌู ุดููุฏุ ุนูุตุฑ `vector` ุฎุฑูุฌ ูุฑุจูุทู ุงุฒ ูุชุฌู ุญุฐู ุดุฏู ู ุจุง ฺฉ `annotation` ุณุทุญ ูุดุฏุงุฑ (warn-level) ุนูุงูุชโฺฏุฐุงุฑ ูโุดูุฏ. ุฌุฒุฆุงุช ุจุดุชุฑ ุฑุง ูโุชูุงู ุฏุฑ `native histogram specification` ุงูุช.

ุนุจุงุฑุช **Native Histograms** ฺฉ ุงุฒ ูุงุจูุชโูุง ุฌุฏุฏ ุฏุฑ **Prometheus** ุงุณุช ฺฉู ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ู ุฏูุช ุฏุฑ ุฐุฎุฑูโุณุงุฒ ู ูพุฑุฏุงุฒุด **ุชูุฒุน ููุงุฏุฑ (distribution of values)** ุจู ฺฉุงุฑ ูโุฑูุฏ.



---

## ๐ฆ Native Histograms ุฏุฑ Prometheus ฺุณุชุ

โ**Native Histograms** ููุน ุฌุฏุฏ ุงุฒ ุฏุงุฏูโูุง ุฏุฑ Prometheus ูุณุชูุฏ ฺฉู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุชูุฒุน ููุงุฏุฑ ุจูโุตูุฑุช **ูุดุฑุฏู ู ุฏููโุชุฑ** ุทุฑุงุญ ุดุฏูโุงูุฏุ ุจูโูฺู ุจุฑุง ุฏุงุฏูโูุง ูุซู latencyุ duration ุง ุงูุฏุงุฒูโูุง.

ุขูโูุง ุฌุงฺฏุฒู ุง ูฺฉูู ุจุฑุง **classic histograms** (`*_bucket` metrics) ูุณุชูุฏ.

---

## ๐ ุชูุงูุช ุจุง Classic Histograms

### ๐ฏ Classic Histogram (ูุฏู):

* ุงุฒ ูุชุฑฺฉโูุง ูุซู `http_request_duration_seconds_bucket{le="0.5"}` ุงุณุชูุงุฏู ูโฺฉูุฏ.
* ุจุฑุง ูุฑ bucket ฺฉ ูุชุฑฺฉ ุฌุฏุง ุฏุงุฑุฏ.
* ุฏูุช ูพุงูโุชุฑ ู ุญุฌู ุฐุฎุฑูโุณุงุฒ ุจุดุชุฑ.
* ูุญุงุณุจุงุช ุฑู ุขูโูุง ูพฺุฏูโุชุฑ ู ูพุฑูุฒููโุชุฑ ุงุณุช.

### โก Native Histogram:

* ุจู ุตูุฑุช **ฺฉ ูุชุฑฺฉ ูุงุญุฏ** ุฐุฎุฑู ูโุดูุฏ (ูู ฺูุฏ `*_bucket` ุฌุฏุง).
* ุฏูุช ุจุงูุง ุฏุฑ ูุญุฏูุฏู ูุณุน.
* ฺฉุงุฑุขูุฏุชุฑ ุฏุฑ ูุตุฑู ุญุงูุธู ู ูุถุง ุฐุฎุฑูโุณุงุฒ.
* ุงุฒ ูุญุงุธ ุนููฺฉุฑุฏ ุจุฑุง query ุจุณุงุฑ ุณุฑุนโุชุฑ ุงุณุช.

---

## ๐ฌ ฺุทูุฑ ฺฉุงุฑ ูโฺฉูุฏุ

* ุงุฒ **logarithmic bucketing** ุงุณุชูุงุฏู ูโฺฉูุฏุ ุนู ููุงุตู ุจู bucketูุง ุจุณุชู ุจู ููุฏุงุฑ ุชุบุฑ ูโฺฉููุฏ.
* ุจู ุทูุฑ **ูุดุฑุฏูโุดุฏู** ู **ุจุงูุฑ** ุฐุฎุฑู ูโุดูุฏ.
* โPrometheus ุงุฒ ูุณุฎู **v2.40** ุจู ุจุนุฏ ุงุฒ ุขู ูพุดุชุจุงู ูโฺฉูุฏ.

---

## ๐ ููููู ูุชุฑฺฉ:

ุจู ุฌุง ุฏุงุดุชู ฺูุฏ ูุชุฑฺฉ ูุซู:

```
http_request_duration_seconds_bucket{le="0.1"}
http_request_duration_seconds_bucket{le="0.5"}
...
```

ุฏุฑ Native Histogram ูููโ ุงูโูุง ุฏุฑ ฺฉ **ูุชุฑฺฉ compact** ุฐุฎุฑู ูโุดูุฏ ูุซู:

```
http_request_duration_seconds
```

ู ููุน ุขู ุจู ุตูุฑุช `histogram` ุฏุฑ ูุชุงุฏุชุง ุชุนุฑู ูโุดูุฏ.

---

## โ ูุฒุงุง:

| ูฺฺฏ                           | ุชูุถุญ                                                |
| ------------------------------- | ---------------------------------------------------- |
| ๐ฏ ุฏูุช ุจุงูุง                     | ุญุช ุฏุฑ ุจุงุฒูโูุง ุจุณุงุฑ ฺฉูฺฺฉ ุง ุจุฒุฑฺฏ                   |
| ๐ฆ ูุตุฑู ูุถุง ฺฉูุชุฑ               | ฺูู ูุดุฑุฏู ุงุณุช                                        |
| ๐ ฺฉุงุฑุง ุจุงูุง ุฏุฑ Query         | ูุฎุตูุตุงู ุฏุฑ queryูุง ุทููุงู ูุฏุช ุง aggregate          |
| ๐ ููุงุณุจ ุจุฑุง long-term storage | ุจุง TSDBูุง ูุซู Thanos ู Cortex ูู ุณุงุฒฺฏุงุฑุชุฑ ุฎูุงูุฏ ุดุฏ |

---

## ๐ง ูุนุงูโุณุงุฒ:

ุจุฑุง ูุนุงูโุณุงุฒ Native Histograms ุฏุฑ ฺฉ exporter (ูุซูุงู Go client):

```go
prometheus.NewHistogram(prometheus.HistogramOpts{
    Name:                   "http_request_duration_seconds",
    NativeHistogramBucketFactor: 1.1, // ูุนุงูโุณุงุฒ native histogram
})
```

> ุงู ูุงุจูุช ูุนูุงู **opt-in** ุงุณุชุ ุนู ุจุงุฏ ุจูโุตูุฑุช ุฏุณุช ูุนุงู ุดูุฏ.

---




**`Literals`**

ุฏุฑ **PromQL** (ุฒุจุงู ฺฉูุฆุฑโููุณ Prometheus)ุ **String Literals** ุจู ุฑุดุชูโูุง ุงุทูุงู ูโุดูุฏ ฺฉู ุจุฑุง ููุชุฑ ฺฉุฑุฏูุ ููุงุณูุ ุง ููุฏุงุฑุฏู ุจู **label**โูุง ู ุจุฑุฎ ุชูุงุจุน ุงุณุชูุงุฏู ูโุดููุฏ.

---

## ๐ค ุชุนุฑู String Literal ุฏุฑ Prometheus:

โ**String Literal** ุฏุฑ Prometheus ุนู **ฺฉ ููุฏุงุฑ ูุชู ูุญุตูุฑ ุฏุฑ ฺฉูุชุดู (`" "` ุง `' '`)** ฺฉู ุฏุฑ ฺฉูุฆุฑโูุง ุงุณุชูุงุฏู ูโุดูุฏ โ ูุนูููุงู ุจุฑุง **ููุฏุงุฑ ุจุฑฺุณุจโูุง (labels)** ุง ูุฑูุฏ ุจุฑุฎ ุชูุงุจุน.

---

## ๐ ูุซุงูโูุง ุฑุงุฌ:

### 1. **ุฏุฑ ููุชุฑ ฺฉุฑุฏู Labelูุง**

```promql
http_requests_total{job="api-server"}
```

ุฏุฑ ุงูุฌุง `"api-server"` ฺฉ **string literal** ุงุณุช ฺฉู ุจุฑุง ููุชุฑ ฺฉุฑุฏู ููุฏุงุฑ ุจุฑฺุณุจ `job` ุงุณุชูุงุฏู ูโุดูุฏ.

---

### 2. **ุจุง regular expressions (regex)**

```promql
http_requests_total{instance=~"web-[0-9]+"}
```

ุฏุฑ ุงูุฌุง `"web-[0-9]+"` ฺฉ string literal ุจุฑุง ฺฉ **ุนุจุงุฑุช ููุธู (regex)** ุงุณุช.

---

### 3. **ุฏุฑ ุชูุงุจุน ูุซู `label_replace()`**

```promql
label_replace(up, "new_label", "$1", "job", "(.*)")
```

ุฏุฑ ุงู ุชุงุจุนุ `"new_label"`, `"$1"`, `"job"` ู `"(.*)"` ููฺฏ string literal ูุณุชูุฏ.

---

## โ ูฺฉุงุช ููู:

| ูฺฺฏ                                         | ุชูุถุญ                                      |
| --------------------------------------------- | ------------------------------------------ |
| ูุญุตูุฑ ุฏุฑ `" "` ุง `' '`                       | ูุนูููุงู ุงุฒ `" "` ุงุณุชูุงุฏู ูโุดูุฏ            |
| ุงุบูุจ ุฏุฑ ููุชุฑ label ุงุณุชูุงุฏู ูโุดูุฏ            | ุจู ุดฺฉู `label="value"` ุง `label=~"regex"` |
| ุงุณุชูุงุฏู ุฏุฑ ุชูุงุจุน ุฎุงุต                          | ูุซู `label_replace`, `label_join`, ู ...   |
| ููุท ููุน **String** ุฏุฑ labelูุง ูพุดุชุจุงู ูโุดูุฏ | ุนู labelูุง ููุท ุฑุดุชู ูุณุชูุฏ                |

---

## โ ุบูุท ุฑุงุฌ:

```promql
up{job=api-server}   โ ุงุดุชุจุงู: ููุฏุงุฑ ุจุงุฏ ุฏุฑ ฺฉูุชุดู ุจุงุดุฏ
```

โ ุฏุฑุณุช:

```promql
up{job="api-server"}
```

---



**`String literals`**
`โString literals` ุจุง `single quotes`ุ `double quotes` ุง `backticks` ูุดุฎุต ูโุดููุฏ.

โ`PromQL` ุงุฒ ููุงู `escaping rules` ุฒุจุงู `Go` ูพุฑู ูโฺฉูุฏ. ุจุฑุง `string literals` ุฏุฑ `single` ุง `double quotes`ุ ฺฉ `backslash` ฺฉ `escape sequence` ุฑุง ุขุบุงุฒ ูโฺฉูุฏุ ฺฉู ููฺฉู ุงุณุช ุจุง `a`, `b`, `f`, `n`, `r`, `t`, `v` ุง `\` ุฏูุจุงู ุดูุฏ. ฺฉุงุฑุงฺฉุชุฑูุง ุฎุงุต ุฑุง ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ููุงุฏฺฏุฐุงุฑ `octal` (`\nnn`) ุง `hexadecimal` (`\xnn`, `\unnnn` ู `\Unnnnnnnn`) ุงุฑุงุฆู ุฏุงุฏ.

ุจุฑุนฺฉุณุ ฺฉุงุฑุงฺฉุชุฑูุง `escape` ุฏุฑ `string literals` ูุดุฎุต ุดุฏู ุจุง `backticks` ุชุฌุฒู ููโุดููุฏ. ููู ุงุณุช ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุจุฑุฎูุงู `Go`ุ `Prometheus` `newlines` ุฏุงุฎู `backticks` ุฑุง ุญุฐู ููโฺฉูุฏ.

ูุซุงู:

```
"this is a string"
'these are unescaped: \n \\ \t'
`these are not unescaped: \n ' " \t`
```

**`Float literals` ู `time durations`**
ููุงุฏุฑ `Scalar` `float` ุฑุง ูโุชูุงู ุจู ุตูุฑุช ุงุนุฏุงุฏ `integer` ุง `floating-point` `literal` ุฏุฑ ูุงูุจ ุฒุฑ ููุดุช (ูุถุง ุฎุงู ููุท ุจุฑุง ุฎูุงูุง ุจูุชุฑ ฺฏูุฌุงูุฏู ุดุฏู ุงุณุช):

```
[-+]?(
      [0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?
    | 0[xX][0-9a-fA-F]+
    | [nN][aA][nN]
    | [iI][nN][fF]
)
```

ูุซุงูโูุง:

```
23
-2.43
3.4e-9
0x8f
-Inf
NaN
```

ุนูุงูู ุจุฑ ุงูุ `underscores` (_) ุฑุง ูโุชูุงู ุจู ุงุฑูุงู `decimal` ุง `hexadecimal` ุจุฑุง ุจูุจูุฏ ุฎูุงูุง ุงุณุชูุงุฏู ฺฉุฑุฏ.

ูุซุงูโูุง:

```
1_000_000
.123_456_789
0x_53_AB_F3_82
```

โ`Float literals` ููฺูู ุจุฑุง ูุดุฎุต ฺฉุฑุฏู `durations` ุจุฑ ุญุณุจ ุซุงูู ุงุณุชูุงุฏู ูโุดููุฏ. ุจุฑุง ุฑุงุญุชุ ุงุนุฏุงุฏ `integer` `decimal` ููฺฉู ุงุณุช ุจุง `time units` ุฒุฑ ุชุฑฺฉุจ ุดููุฏ:

* โ  `ms` โ milliseconds
* โ  `s` โ seconds โ 1s ุจุฑุงุจุฑ ุงุณุช ุจุง 1000ms
* โ  `m` โ minutes โ 1m ุจุฑุงุจุฑ ุงุณุช ุจุง 60s (ูุงุฏุฏู ฺฏุฑูุชู leap seconds)
* โ  `h` โ hours โ 1h ุจุฑุงุจุฑ ุงุณุช ุจุง 60m
* โ  `d` โ days โ 1d ุจุฑุงุจุฑ ุงุณุช ุจุง 24h (ูุงุฏุฏู ฺฏุฑูุชู daylight saving time)
* โ  `w` โ weeks โ 1w ุจุฑุงุจุฑ ุงุณุช ุจุง 7d
* โ  `y` โ years โ 1y ุจุฑุงุจุฑ ุงุณุช ุจุง 365d (ูุงุฏุฏู ฺฏุฑูุชู leap days)

ุงูุฒูุฏู ูพุณููุฏ ฺฉ ุงุฒ ูุงุญุฏูุง ุจุงูุง ุจู ฺฉ ุนุฏุฏ `integer` `decimal`ุ ููุงุด ูุชูุงูุช ุงุฒ ูุนุงุฏู ุชุนุฏุงุฏ ุซุงูู ุจู ุนููุงู ฺฉ `float literal` ุฎุงู ุงุณุช.

ูุซุงูโูุง:

```
1s # ูุนุงุฏู 1.
2m # ูุนุงุฏู 120.
1ms # ูุนุงุฏู 0.001.
-2h # ูุนุงุฏู -7200.
```

ูุซุงูโูุง ุฒุฑ ฺฉุงุฑ ููโฺฉููุฏ:

```
0xABm # ุนุฏู ุงูฺฉุงู ูพุณููุฏฺฏุฐุงุฑ ุงุนุฏุงุฏ hexadecimal.
1.5h # Time units ุฑุง ููโุชูุงู ุจุง ฺฉ floating point ุชุฑฺฉุจ ฺฉุฑุฏ.
+Infd # ุนุฏู ุงูฺฉุงู ูพุณููุฏฺฏุฐุงุฑ ยฑInf ุง NaN.
```

ฺูุฏู ูุงุญุฏ ุฑุง ูโุชูุงู ุจุง `concatenation` ุงุนุฏุงุฏ ุตุญุญ ูพุณููุฏุฏุงุฑ ุชุฑฺฉุจ ฺฉุฑุฏ. ูุงุญุฏูุง ุจุงุฏ ุงุฒ ุทููุงูโุชุฑู ุจู ฺฉูุชุงูโุชุฑู ูุฑุชุจ ุดููุฏ. ฺฉ ูุงุญุฏ ุฏุงุฏู ุดุฏู ููุท ุจุงุฏ ฺฉ ุจุงุฑ ุฏุฑ ูุฑ `float literal` ุธุงูุฑ ุดูุฏ.

ูุซุงูโูุง:

```
1h30m # ูุนุงุฏู 5400s ู ุจูุงุจุฑุงู 5400.
12h34m56s # ูุนุงุฏู 45296s ู ุจูุงุจุฑุงู 45296.
54s321ms # ูุนุงุฏู 54.321.
```

**`Time series selectors`**
ุงููุง ุจููฺฉโูุง ุณุงุฒูุฏู ุงุตู ูุณุชูุฏ ฺฉู ุจู `PromQL` ุฏุณุชูุฑ ูโุฏููุฏ ฺู ุฏุงุฏูโูุง ุฑุง `fetch` ฺฉูุฏ.

### **`Instant vector selectors`**

ุฏุฑ Prometheus ู ุฒุจุงู ฺฉูุฆุฑ PromQLุ ููููู **Instant Vector Selector** ุจู ฺฉูุฆุฑโูุง ุงุดุงุฑู ุฏุงุฑุฏ ฺฉู **ุณุฑโูุง ุฒูุงู (time series) ุฑุง ุฏุฑ ฺฉ ูุญุธู ูุดุฎุต** ุงูุชุฎุงุจ ูโฺฉููุฏ โ ูุนูููโุชุฑู ู ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ููุน ฺฉูุฆุฑ ุฏุฑ PromQL ุงุณุช.

---

## ๐ข ุชุนุฑู ุณุงุฏู:

**Instant Vector Selector** ุนู:
๐น ยซุงูุชุฎุงุจ ฺฉ ุง ฺูุฏ ุณุฑ ุฒูุงู ุฏุฑ ฺฉ ููุทู ุฒูุงู ุฎุงุต (ูุนูููุงู "ุงูุงู")ยป

---

## โ ูฺฺฏโูุง:

| ูฺฺฏ                     | ุชูุถุญ                                                                      |
| ------------------------- | -------------------------------------------------------------------------- |
| ููุท ฺฉ ููุฏุงุฑ ุฏุฑ ุฒูุงู ูุดุฎุต | ุงุฒ ูุฑ ุณุฑ ุฒูุงูุ ููุฏุงุฑ ูุฑุจูุท ุจู "ุงูุงู" (ุง ฺฉ ุฒูุงู ุฎุงุต) ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ     |
| ุจุฏูู ุจุงุฒู ุฒูุงู `[ ]`     | ุงฺฏุฑ ุจุงุฒู ูุซู `[5m]` ูุฏุงุดุชู ุจุงุดูุ ุนู Instant Vector ูุณุช                   |
| ูพุงูโ ุงฺฉุซุฑ ฺฉูุฆุฑโูุง      | ููุงุดโูุง ฺฏุฑุงูุ alertูุง ู ุจุณุงุฑ ุงุฒ ูุญุงุณุจุงุช ุงุฒ Instant Vector ุดุฑูุน ูโุดููุฏ |

---

## ๐ ูุซุงูโูุง:

### 1. ุณุงุฏูโุชุฑู ุญุงูุช:

```promql
up
```

ุงู ฺฉูุฆุฑ ููู ุณุฑโูุง ุฒูุงู ุจุง ูุงู `up` ุฑุง ุฏุฑ ููู ูุญุธู (now) ุงูุชุฎุงุจ ูโฺฉูุฏ.

---

### 2. ุจุง Label Selector:

```promql
node_cpu_seconds_total{mode="idle", instance="server01:9100"}
```

ุงู ฺฉ Instant Vector Selector ุงุณุช ฺฉู ููุท ุณุฑโูุง ุจุง ุงู ุจุฑฺุณุจโูุง ุฑุง ุฏุฑ ูุญุธู ุฌุงุฑ ุงูุชุฎุงุจ ูโฺฉูุฏ.

---

### 3. ุจุง Offset (ุฌุงุจูโุฌุง ุฒูุงู):

```promql
http_requests_total offset 1h
```

ููุฏุงุฑ ูุชุฑฺฉ ุฑุง ุฏุฑ **ุฏููุงู 1 ุณุงุนุช ูุจู** ุจุฑูโฺฏุฑุฏุงูุฏ โ ููฺูุงู ฺฉ Instant Vector ุงุณุชุ ูู ูู ุจุฑุง "ุงูุงู".

---

### 4. ุงุดุชุจุงู ุฑุงุฌ โ Range Vector ูุณุช:

```promql
rate(http_requests_total[5m])   โ ุงู ฺฉ Range Vector ุงุณุชุ ูู Instant
```

---

## ๐ง ุงุฏุขูุฑ:

**ุงฺฏุฑ ฺฉูุฆุฑ ูฺ `[ ]` ูุฏุงุดุชู ุจุงุดุฏ ู ูุชุฑฺฉ ุฑุง ุฏุฑ ูุญุธูโุง ูุดุฎุต (ุงูุงู ุง ุจุง offset) ุจุฎูุงูุฏุ ุขู ุฑุง ฺฉ Instant Vector Selector ูโูุงูู.**


โ`Instant vector selectors` ุงูฺฉุงู ุงูุชุฎุงุจ ูุฌููุนูโุง ุงุฒ `time series` ู ฺฉ ููุฏุงุฑ `sample` ุจุฑุง ูุฑ ฺฉุฏุงู ุฏุฑ ฺฉ `timestamp` ูุนู (ููุทู ุฒูุงู) ุฑุง ูุฑุงูู ูโฺฉููุฏ. ุฏุฑ ุณุงุฏูโุชุฑู ุดฺฉูุ ููุท ฺฉ `metric name` ูุดุฎุต ูโุดูุฏุ ฺฉู ููุฌุฑ ุจู ฺฉ `instant vector` ุญุงู ุนูุงุตุฑ ุจุฑุง ุชูุงู `time series`ูุง ูโุดูุฏ ฺฉู ุงู `metric name` ุฑุง ุฏุงุฑูุฏ.

ููุฏุงุฑ ุจุงุฒฺฏุดุชุ ููุฏุงุฑ ุฌุฏุฏุชุฑู `sample` ุฏุฑ ุง ูุจู ุงุฒ `timestamp` ุงุฑุฒุงุจ `query` (ุฏุฑ ููุฑุฏ `instant query`) ุง ฺฏุงู ูุนู ุฏุฑูู `query` (ุฏุฑ ููุฑุฏ `range query`) ุฎูุงูุฏ ุจูุฏ. `@ modifier` ุงุฌุงุฒู ูโุฏูุฏ `timestamp` ฺฉู ุงูุชุฎุงุจ ูุณุจุช ุจู ุขู ุงูุฌุงู ูโุดูุฏ ุฑุง ุจุงุฒููุณ ฺฉูุฏ. `Time series`ูุง ุชููุง ุฏุฑ ุตูุฑุช ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ ฺฉู ุฌุฏุฏุชุฑู `sample` ุขููุง ฺฉูุชุฑ ุงุฒ ุฏูุฑู `lookback period` ูพุด ุจุงุดุฏ.

ุงู ูุซุงู ุชูุงู `time series`ูุง ุฑุง ฺฉู `metric name` `http_requests_total` ุฏุงุฑูุฏ ุงูุชุฎุงุจ ูโฺฉูุฏ ู ุฌุฏุฏุชุฑู `sample` ุฑุง ุจุฑุง ูุฑ ฺฉุฏุงู ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```promql
http_requests_total
```

ุงูฺฉุงู ููุชุฑ ฺฉุฑุฏู ุจุดุชุฑ ุงู `time series`ูุง ุจุง ุงูุฒูุฏู ูุณุช ุงุฒ `label matchers` ุฌุฏุง ุดุฏู ุจุง ฺฉุงูุง ุฏุฑ `curly braces ({})` ูุฌูุฏ ุฏุงุฑุฏ.

ุงู ูุซุงู ููุท ุขู `time series`ูุง ุฑุง ุจุง `metric name` `http_requests_total` ุงูุชุฎุงุจ ูโฺฉูุฏ ฺฉู ููฺูู `label` `job` ุขููุง ุฑู `prometheus` ู `label` `group` ุขููุง ุฑู `canary` ุชูุธู ุดุฏู ุจุงุดุฏ:

```promql
http_requests_total{job="prometheus",group="canary"}
```

ููฺูู ุงูฺฉุงู ุชุทุจู ููู ฺฉ `label value`ุ ุง ุชุทุจู `label values` ุจุง `regular expressions` ูุฌูุฏ ุฏุงุฑุฏ. `label matching operators` ุฒุฑ ูุฌูุฏ ุฏุงุฑูุฏ:

*   `=`: ุงูุชุฎุงุจ `labels` ฺฉู ุฏููุงู ุจุฑุงุจุฑ ุจุง `string` ุงุฑุงุฆู ุดุฏู ูุณุชูุฏ.
*   `!=`: ุงูุชุฎุงุจ `labels` ฺฉู ุจุฑุงุจุฑ ุจุง `string` ุงุฑุงุฆู ุดุฏู ูุณุชูุฏ.
*   `=~`: ุงูุชุฎุงุจ `labels` ฺฉู ุจุง `regex` ุจุง `string` ุงุฑุงุฆู ุดุฏู ูุทุงุจูุช ุฏุงุฑูุฏ.
*   `!~`: ุงูุชุฎุงุจ `labels` ฺฉู ุจุง `regex` ุจุง `string` ุงุฑุงุฆู ุดุฏู ูุทุงุจูุช ูุฏุงุฑูุฏ.

ุชุทุงุจูโูุง `Regex` ฺฉุงููุงู `anchored` ูุณุชูุฏ. ุชุทุงุจู `"env=~"foo` ุจู ุนููุงู `"$env=~"^foo` ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.

ุจู ุนููุงู ูุซุงูุ ุงู ููุฑุฏ ุชูุงู `time series`ูุง `http_requests_total` ุฑุง ุจุฑุง ูุญุทโูุง `staging`ุ `testing` ู `development` ู `HTTP methods` ุบุฑ ุงุฒ `GET` ุงูุชุฎุงุจ ูโฺฉูุฏ.

```promql
http_requests_total{environment=~"staging|testing|development",method!="GET"}
```

โ`Label matchers` ฺฉู ุจุง `label values` ุฎุงู ูุทุงุจูุช ุฏุงุฑูุฏุ ููฺูู ุชูุงู `time series`ูุง ุฑุง ุงูุชุฎุงุจ ูโฺฉููุฏ ฺฉู `label` ูุดุฎุต ุดุฏู ุฑุง ุงุตูุงู ูุฏุงุฑูุฏ. ุงูฺฉุงู ุฏุงุดุชู ฺูุฏู `matcher` ุจุฑุง ฺฉ `label name` ูุฌูุฏ ุฏุงุฑุฏ.

ุจู ุนููุงู ูุซุงูุ ุจุง ุชูุฌู ุจู `dataset`:

```
http_requests_total
http_requests_total{replica="rep-a"}
http_requests_total{replica="rep-b"}
http_requests_total{environment="development"}
```

`query` `http_requests_total{environment=""}` 
ูุทุงุจูุช ุฏุงุฏู ู ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```
http_requests_total
http_requests_total{replica="rep-a"}
http_requests_total{replica="rep-b"}
```

ู ูุณุชุซู ูโฺฉูุฏ:

```
http_requests_total{environment="development"}
```

ูโุชูุงู ุงุฒ ฺูุฏู `matcher` ุจุฑุง ฺฉ `label name` ุงุณุชูุงุฏู ฺฉุฑุฏุ ููู ุขููุง ุจุงุฏ ุจุฑูุฑุงุฑ ุจุงุดูุฏ ุชุง ูุชุฌูโุง ุจุงุฒฺฏุฑุฏุงูุฏู ุดูุฏ.

`query`:

```promql
http_requests_total{replica!="rep-a",replica=~"rep.*"}
```

ุณูพุณ ูุทุงุจูุช ูโุฏูุฏ:

```
http_requests_total{replica="rep-b"}
```

โ`Vector selectors` ุจุงุฏ ุง ฺฉ ูุงู ูุดุฎุต ฺฉููุฏ ุง ุญุฏุงูู ฺฉ `label matcher` ฺฉู ุจุง `string` ุฎุงู ูุทุงุจูุช ูุฏุงุดุชู ุจุงุดุฏ. `expression` ุฒุฑ ุบุฑูุงููู ุงุณุช:

```promql
{job=~".*"} # Bad!
```

ุฏุฑ ููุงุจูุ ุงู `expression`ูุง ูุนุชุจุฑ ูุณุชูุฏ ุฒุฑุง ูุฑ ุฏู ุฏุงุฑุง ฺฉ `selector` ูุณุชูุฏ ฺฉู ุจุง `label values` ุฎุงู ูุทุงุจูุช ูุฏุงุฑุฏ.

```promql
{job=~".+"}              # Good!
{job=~".*",method="get"} # Good!
```

โ`Label matchers` ุฑุง ูโุชูุงู ุจุง ุชุทุจู ุจุง `label` ุฏุงุฎู `__name__` ุจู `metric names` ูุฒ ุงุนูุงู ฺฉุฑุฏ. ุจู ุนููุงู ูุซุงูุ `expression` `http_requests_total` ูุนุงุฏู `{__name__="http_requests_total"}` ุงุณุช. `Matchers` ุบุฑ ุงุฒ `=` (`!=`, `=~`, `!~`) ูุฒ ููฺฉู ุงุณุช ุงุณุชูุงุฏู ุดููุฏ. `expression` ุฒุฑ ุชูุงู `metrics` ุฑุง ฺฉู ูุงูุดุงู ุจุง `job:` ุดุฑูุน ูโุดูุฏ ุงูุชุฎุงุจ ูโฺฉูุฏ:

```promql
{__name__=~"job:.*"}
```

โ`Metric name` ูุจุงุฏ ฺฉ ุงุฒ `keywords` `bool`, `on`, `ignoring`, `group_left` ู `group_right` ุจุงุดุฏ. `expression` ุฒุฑ ุบุฑูุงููู ุงุณุช:

```promql
on{} # Bad!
```

ฺฉ ุฑุงู ุญู ุจุฑุง ุงู ูุญุฏูุฏุช ุงุณุชูุงุฏู ุงุฒ `label` `__name__` ุงุณุช:

```promql
{__name__="on"} # Good!
```


ุฏุฑ Prometheus ู ุฒุจุงู **PromQL**ุ ุนุจุงุฑุช **Range Vector Selector** ุจุฑุง ุงูุชุฎุงุจ **ูุฌููุนูโุง ุงุฒ ุฏุงุฏูโูุง ุณุฑ ุฒูุงู ุฏุฑ ฺฉ ุจุงุฒู ุฒูุงู ูุดุฎุต** ุจู ฺฉุงุฑ ูโุฑูุฏ.

---

## ๐ฆ ุชุนุฑู ุณุงุฏู:

**Range Vector Selector** ุนู:

> ุงูุชุฎุงุจ ุณุฑ ุฒูุงู ุจูโููุฑุงู ุชูุงู ููุฏุงุฑูุง (ูููููโูุง) ุขู ุฏุฑ ฺฉ **ุจุงุฒู ุฒูุงู ูุดุฎุต**ุ ูุซูุงู ุฏุฑ 5 ุฏููู ุง 1 ุณุงุนุช ฺฏุฐุดุชู.

---

## ๐ ุณุงุฎุชุงุฑ ฺฉู:

```
<metric_name>[<duration>]
```

ูุซุงู:

```promql
http_requests_total[5m]
```

ุนู: ุชูุงู ูููููโูุง (samples) ุณุฑ ุฒูุงู `http_requests_total` ุฑุง ุฏุฑ **ต ุฏูููโ ฺฏุฐุดุชู** ุงูุชุฎุงุจ ฺฉู.

---

## โ ูฺฺฏโูุง Range Vector:

| ูฺฺฏ                                  | ุชูุถุญ                                                 |
| -------------------------------------- | ----------------------------------------------------- |
| ุดุงูู ฺูุฏู ููุทู ุฏุงุฏู                   | ุจุฑุฎูุงู Instant Vector ฺฉู ููุท ฑ ููุฏุงุฑ ุฏุฑ ุฒูุงู ุฎุงุต ุฏุงุฑุฏ |
| ุจุงุฒู ุฒูุงู ุตุฑุญ ุฏุงุฑุฏ                   | ูุซูุงู `[1m]`, `[5m]`, `[1h]`, `[30s]`                 |
| ููุท ุจุง ุจุนุถ ุชูุงุจุน ฺฉุงุฑ ูโฺฉูุฏ           | ูุซู `rate()`, `avg_over_time()`, `max_over_time()`    |
| ูพุงูโ ูุญุงุณุจูู ูุฑุฎุ ูุงูฺฏูุ ุฏุฑุตุฏ ู... | ฺูู ุจุฑุง ุชุญูู ุฑููุฏ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ            |

---

## ๐ ูุซุงูโูุง ุฑุงุฌ:

### 1. ููุท ุงูุชุฎุงุจ ุจุงุฒู:

```promql
node_cpu_seconds_total[2m]
```

ุชูุงู ุฏุงุฏูโูุง ุงู ูุชุฑฺฉ ุฏุฑ ฒ ุฏููู ฺฏุฐุดุชู โ ุฎุฑูุฌ ฺฉ **Range Vector** ุงุณุช.

---

### 2. ุงุณุชูุงุฏู ุฏุฑ ุชุงุจุน `rate()`:

```promql
rate(http_requests_total[1m])
```

ูุงูฺฏู ูุฑุฎ ุฑุดุฏ ุงู ูุชุฑฺฉ ุฏุฑ ฑ ุฏููู ฺฏุฐุดุชู ุฑุง ุญุณุงุจ ูโฺฉูุฏ.

---

### 3. ุงุณุชูุงุฏู ุฏุฑ ุชุงุจุน `avg_over_time()`:

```promql
avg_over_time(node_load1[15m])
```

ูุงูฺฏู ุจุงุฑ ุณุณุชู ุฏุฑ ฑต ุฏููู ฺฏุฐุดุชู.

---

## โ๏ธ ุชูุงูุช ุจุง Instant Vector:

| ูฺฺฏ  | Instant Vector       | Range Vector               |
| ------ | -------------------- | -------------------------- |
| ุฒูุงู   | ููุท ฺฉ ูุญุธู          | ฺฉ ุจุงุฒู ุฒูุงู              |
| ููุฏุงุฑ  | ููุท ุขุฎุฑู ููููู      | ฺูุฏู ููููู                |
| ููุงุฏ   | ุจุฏูู `[ ]`           | ุจุง `[duration]`            |
| ฺฉุงุฑุจุฑุฏ | ูุดุงูุฏู ูุถุนุช ูุญุธูโุง | ุชุญูู ุขูุงุฑ ุฑู ุฒูุงู ฺฏุฐุดุชู |

---

## ๐ง ูฺฉุชู:

๐น ุงฺฏุฑ ุฏุฑ PromQL ุฏุฏ ูุชุฑฺฉ ุฏุฑ ฺฉูุงุฑ `[5m]` ุง `[30s]` ุขูุฏูุ ุจุฏูู ูฺ ุชุงุจุนุ ุงูู **Range Vector Selector** ุงุณุช.
๐น ุงูุง ุจุฑุง ุงูฺฉู ูุนูโุฏุงุฑ ุจุดู (ูุซูุงู rate ูุญุงุณุจู ุดู)ุ ูุนูููุงู ุจุงุฏ ุจุง ุชูุงุจุน ุงุณุชูุงุฏู ุจุดู.

---




**`Range Vector Selectors`**
โ`Range vector literals` ูุงููุฏ `instant vector literals` ฺฉุงุฑ ูโฺฉููุฏุ ุจุง ุงู ุชูุงูุช ฺฉู ูุญุฏูุฏูโุง ุงุฒ `samples` ุฑุง ุงุฒ ูุญุธู ูุนู ุจู ุนูุจ ุงูุชุฎุงุจ ูโฺฉููุฏ. ุงุฒ ูุธุฑ ูุญูุ ฺฉ `float literal` ุฏุฑ `square brackets ([])` ุฏุฑ ุงูุชูุง ฺฉ `vector selector` ุงุถุงูู ูโุดูุฏ ุชุง ูุดุฎุต ฺฉูุฏ ููุงุฏุฑ ุจุฑุง ฺูุฏ ุซุงูู ูุจู ุฏุฑ ุฒูุงู ุจุงุฏ ุจุฑุง ูุฑ ุนูุตุฑ `range vector` ูุชุฌู `fetch` ุดููุฏ. ูุนูููุงูุ `float literal` ุงุฒ ุณูุชฺฉุณ ุจุง ฺฉ ุง ฺูุฏ `time units` ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุซูุงู `[5m]`. ูุญุฏูุฏู ฺฉ `interval` ุจุงุฒ ุงุฒ ฺูพ ู ุจุณุชู ุงุฒ ุฑุงุณุช ุงุณุชุ ุนู `samples` ุจุง `timestamps` ููุทุจู ุจุฑ ูุฑุฒ ฺูพ ูุญุฏูุฏู ุงุฒ ุงูุชุฎุงุจ ูุณุชุซู ูโุดููุฏุ ุฏุฑ ุญุงู ฺฉู `samples` ููุทุจู ุจุฑ ูุฑุฒ ุฑุงุณุช ูุญุฏูุฏู ุฏุฑ ุงูุชุฎุงุจ ฺฏูุฌุงูุฏู ูโุดููุฏ.

ุฏุฑ ุงู ูุซุงูุ ูุง ุชูุงู ููุงุฏุฑ ุซุจุช ุดุฏู ฺฉูุชุฑ ุงุฒ 5 ุฏููู ูพุด ุฑุง ุจุฑุง ุชูุงู `time series`ูุง ฺฉู `metric name` `http_requests_total` ู `label` `job` ุขููุง ุฑู `prometheus` ุชูุธู ุดุฏู ุงุณุชุ ุงูุชุฎุงุจ ูโฺฉูู:

```promql
http_requests_total{job="prometheus"}[5m]
```

**`Offset modifier`**
โ`offset modifier` ุงูฺฉุงู ุชุบุฑ `offset` ุฒูุงู ุจุฑุง `instant` ู `range vectors` ูุฌุฒุง ุฏุฑ ฺฉ `query` ุฑุง ูุฑุงูู ูโฺฉูุฏ.

ุจู ุนููุงู ูุซุงูุ `expression` ุฒุฑ ููุฏุงุฑ `http_requests_total` ุฑุง 5 ุฏููู ูุจู ูุณุจุช ุจู ุฒูุงู ุงุฑุฒุงุจ `query` ูุนู ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```promql
http_requests_total offset 5m
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู `offset modifier` ููุดู ุจุงุฏ ุจูุงูุงุตูู ุจุนุฏ ุงุฒ `selector` ุจุงุฏุ ุนู ุนุจุงุฑุช ุฒุฑ ุตุญุญ ุฎูุงูุฏ ุจูุฏ:

```promql
sum(http_requests_total{method="GET"} offset 5m) // GOOD.
```

ุฏุฑ ุญุงู ฺฉู ุนุจุงุฑุช ุฒุฑ ูุงุฏุฑุณุช ุฎูุงูุฏ ุจูุฏ:

```promql
sum(http_requests_total{method="GET"}) offset 5m // INVALID.
```

ููู ุงูุฑ ุจุฑุง `range vectors` ูุฒ ุตุงุฏู ุงุณุช. ุงู `rate` 5 ุฏูููโุง `http_requests_total` ุฑุง ฺฉ ููุชู ูพุด ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```promql
rate(http_requests_total[5m] offset 1w)
```

ููฺฏุงู `query` ุจุฑุง `samples` ุฏุฑ ฺฏุฐุดุชูุ ฺฉ `offset` ููู ุงูฺฉุงู ููุงุณูโูุง ุฒูุงู ุจู ุฌูู ุฏุฑ ุฒูุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ:

```promql
rate(http_requests_total[5m] offset -1w)
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ุจู `query` ุงุฌุงุฒู ูโุฏูุฏ ุฌููุชุฑ ุงุฒ ุฒูุงู ุงุฑุฒุงุจ ุฎูุฏ ุฑุง ูฺฏุงู ฺฉูุฏ.

**`@ modifier`**
โ`@ modifier` ุงูฺฉุงู ุชุบุฑ ุฒูุงู ุงุฑุฒุงุจ ุจุฑุง `instant` ู `range vectors` ูุฌุฒุง ุฏุฑ ฺฉ `query` ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุฒูุงู ุงุฑุงุฆู ุดุฏู ุจู `@ modifier` ฺฉ `unix timestamp` ุงุณุช ู ุจุง ฺฉ `float literal` ุชูุตู ูโุดูุฏ.

ุจู ุนููุงู ูุซุงูุ `expression` ุฒุฑ ููุฏุงุฑ `http_requests_total` ุฑุง ุฏุฑ `2021-01-04T07:40:00+00:00` ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```promql
http_requests_total @ 1609746000
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู `@ modifier` ููุดู ุจุงุฏ ุจูุงูุงุตูู ุจุนุฏ ุงุฒ `selector` ุจุงุฏุ ุนู ุนุจุงุฑุช ุฒุฑ ุตุญุญ ุฎูุงูุฏ ุจูุฏ:

```promql
sum(http_requests_total{method="GET"} @ 1609746000) // GOOD.
```

ุฏุฑ ุญุงู ฺฉู ุนุจุงุฑุช ุฒุฑ ูุงุฏุฑุณุช ุฎูุงูุฏ ุจูุฏ:

```promql
sum(http_requests_total{method="GET"}) @ 1609746000 // INVALID.
```

ููู ุงูุฑ ุจุฑุง `range vectors` ูุฒ ุตุงุฏู ุงุณุช. ุงู `rate` 5 ุฏูููโุง `http_requests_total` ุฑุง ุฏุฑ `2021-01-04T07:40:00+00:00` ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```promql
rate(http_requests_total[5m] @ 1609746000)
```

โ`@ modifier` ุงุฒ ุชูุงู ููุงุดโูุง `numeric literals` ุชูุตู ุดุฏู ุฏุฑ ุจุงูุง ูพุดุชุจุงู ูโฺฉูุฏ. ุงู ุจุง `offset modifier` ฺฉุงุฑ ูโฺฉูุฏ ฺฉู ุฏุฑ ุขู `offset` ูุณุจุช ุจู ุฒูุงู `@ modifier` ุงุนูุงู ูโุดูุฏ. ูุชุงุฌ ุจุฏูู ุชูุฌู ุจู ุชุฑุชุจ `modifier`ูุง ฺฉุณุงู ูุณุชูุฏ.

ุจู ุนููุงู ูุซุงูุ ุงู ุฏู `query` ูุชุฌู ฺฉุณุงู ุชููุฏ ุฎูุงููุฏ ฺฉุฑุฏ:

```promql
# offset after @
http_requests_total @ 1609746000 offset 5m
# offset before @
http_requests_total offset 5m @ 1609746000
```

ุนูุงูู ุจุฑ ุงูุ `start()` ู `end()` ูุฒ ูโุชูุงููุฏ ุจู ุนููุงู ููุงุฏุฑ ูฺู ุจุฑุง `@ modifier` ุงุณุชูุงุฏู ุดููุฏ.

ุจุฑุง ฺฉ `range query`ุ ุขููุง ุจู ุชุฑุชุจ ุจู ุดุฑูุน ู ูพุงุงู `range query` ุชุจุฏู ูโุดููุฏ ู ุจุฑุง ููู ฺฏุงูโูุง ฺฉุณุงู ุจุงู ูโูุงููุฏ.

ุจุฑุง ฺฉ `instant query`ุ `start()` ู `end()` ูุฑ ุฏู ุจู ุฒูุงู ุงุฑุฒุงุจ ุชุจุฏู ูโุดููุฏ.

```promql
http_requests_total @ start()
rate(http_requests_total[5m] @ end())
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู `@ modifier` ุจู `query` ุงุฌุงุฒู ูโุฏูุฏ ุฌููุชุฑ ุงุฒ ุฒูุงู ุงุฑุฒุงุจ ุฎูุฏ ุฑุง ูฺฏุงู ฺฉูุฏ.

**`Subquery`**
โ`Subquery` ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉ `instant query` ุฑุง ุจุฑุง ฺฉ `range` ู `resolution` ูุนู ุงุฌุฑุง ฺฉูุฏ. ูุชุฌู ฺฉ `subquery` ฺฉ `range vector` ุงุณุช.

ุณูุชฺฉุณ: `<instant_query> '[' <range> ':' [<resolution>] ']' [ @ <float_literal> ] [ offset <float_literal> ]`

โ`<resolution>` ุงุฎุชุงุฑ ุงุณุช. ูพุดโูุฑุถ ูุงุตูู ุงุฑุฒุงุจ ุณุฑุงุณุฑ ุงุณุช.

**`Operators`**
โ`Prometheus` ุงุฒ ุจุณุงุฑ ุงุฒ `binary` ู `aggregation operators` ูพุดุชุจุงู ูโฺฉูุฏ. ุงููุง ุจู ุชูุตู ุฏุฑ ุตูุญู `expression language operators` ุดุฑุญ ุฏุงุฏู ุดุฏูโุงูุฏ.

**`Functions`**
โ`Prometheus` ุงุฒ ฺูุฏู `function` ุจุฑุง ุนููุงุช ุฑู ุฏุงุฏูโูุง ูพุดุชุจุงู ูโฺฉูุฏ. ุงููุง ุจู ุชูุตู ุฏุฑ ุตูุญู `expression language functions` ุดุฑุญ ุฏุงุฏู ุดุฏูโุงูุฏ.

**`Comments`**
โ`PromQL` ุงุฒ `line comments` ฺฉู ุจุง `#` ุดุฑูุน ูโุดููุฏ ูพุดุชุจุงู ูโฺฉูุฏ. ูุซุงู:

```promql
    # This is a comment
```

**`Regular expressions`**
ุชูุงู `regular expressions` ุฏุฑ `Prometheus` ุงุฒ ุณูุชฺฉุณ `RE2` ุงุณุชูุงุฏู ูโฺฉููุฏ.

ุชุทุงุจูโูุง `Regex` ููุดู ฺฉุงููุงู `anchored` ูุณุชูุฏ.

**`Gotchas`**

**`Staleness`**
โ`timestamps` ฺฉู ุฏุฑ ุขููุง ุฏุงุฏูโูุง ุฏุฑ ุทูู ฺฉ `query` ูููููโุจุฑุฏุงุฑ ูโุดููุฏุ ูุณุชูู ุงุฒ ุฏุงุฏูโูุง `time series` ูุงูุน ููุฌูุฏ ุงูุชุฎุงุจ ูโุดููุฏ. ุงู ุนูุฏุชุงู ุจุฑุง ูพุดุชุจุงู ุงุฒ ููุงุฑุฏ ูุงููุฏ `aggregation` (`sum`, `avg` ู ุบุฑู) ุงุณุชุ ุฌุง ฺฉู ฺูุฏู `time series` `aggregate` ุดุฏู ุฏููุงู ุฏุฑ ุฒูุงู ุชุฑุงุฒ ูุณุชูุฏ. ุจู ุฏูู ุงุณุชููุงู ุขููุงุ `Prometheus` ูุงุฒ ุฏุงุฑุฏ ุฏุฑ ุขู `timestamps` ุจุฑุง ูุฑ `time series` ูุฑุจูุทู ููุฏุงุฑ ุฑุง ุชุฎุตุต ุฏูุฏ. ุงู ฺฉุงุฑ ุฑุง ุจุง ฺฏุฑูุชู ุฌุฏุฏุชุฑู `sample` ฺฉู ฺฉูุชุฑ ุงุฒ ุฏูุฑู `lookback period` ูพุด ุงุณุชุ ุงูุฌุงู ูโุฏูุฏ. `lookback period` ุจู ุทูุฑ ูพุดโูุฑุถ 5 ุฏููู ุงุณุชุ ุงูุง ูโุชูุงู ุขู ุฑุง ุจุง ูพุฑฺู `--query.lookback-delta` ุชูุธู ฺฉุฑุฏ.

ุงฺฏุฑ ฺฉ `target scrape` ุง `rule evaluation` ุฏฺฏุฑ `sample` ุฑุง ุจุฑุง ฺฉ `time series` ฺฉู ูุจูุงู ูุฌูุฏ ุฏุงุดุช ุจุฑูฺฏุฑุฏุงูุฏุ ุงู `time series` ุจู ุนููุงู `stale` ุนูุงูุชโฺฏุฐุงุฑ ูโุดูุฏ. ุงฺฏุฑ ฺฉ `target` ุญุฐู ุดูุฏุ `time series`ูุง ูุจูุงู ุจุงุฒุงุจ ุดุฏู ุจู ุฒูุฏ ูพุณ ุงุฒ ุญุฐู ุจู ุนููุงู `stale` ุนูุงูุชโฺฏุฐุงุฑ ูโุดููุฏ.

ุงฺฏุฑ ฺฉ `query` ุฏุฑ ฺฉ `sampling timestamp` ูพุณ ุงุฒ ุงูฺฉู ฺฉ `time series` ุจู ุนููุงู `stale` ุนูุงูุชโฺฏุฐุงุฑ ุดุฏ ุงุฑุฒุงุจ ุดูุฏุ ูฺ ููุฏุงุฑ ุจุฑุง ุขู `time series` ุจุงุฒฺฏุฑุฏุงูุฏู ููโุดูุฏ. ุงฺฏุฑ `sample`ูุง ุฌุฏุฏ ูุชุนุงูุจุงู ุจุฑุง ุขู `time series` `ingest` ุดููุฏุ ุทุจู ุงูุชุธุงุฑ ุจุงุฒฺฏุฑุฏุงูุฏู ุฎูุงููุฏ ุดุฏ.

ฺฉ `time series` ุฒูุงู `stale` ูโุดูุฏ ฺฉู ุฏฺฏุฑ `export` ูุดูุฏุ ุง `target` ุฏฺฏุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ. ฺูู `time series`ูุง ุฏุฑ ุฒูุงู ุขุฎุฑู `sample` ุฌูุนโุขูุฑ ุดุฏู ุฎูุฏ ุงุฒ `graphs` ูุงูพุฏุฏ ูโุดููุฏ ู ูพุณ ุงุฒ ุนูุงูุชโฺฏุฐุงุฑ ุจู ุนููุงู `stale` ุฏุฑ `queries` ุจุงุฒฺฏุฑุฏุงูุฏู ูุฎูุงููุฏ ุดุฏ.

ุจุฑุฎ `exporters` ฺฉู `timestamp`ูุง ุฎูุฏ ุฑุง ุฑู `sample`ูุง ูุฑุงุฑ ูโุฏููุฏุ ุฑูุชุงุฑ ูุชูุงูุช ุฏุงุฑูุฏ: `series`ูุง ฺฉู `export` ุดุฏู ุขููุง ูุชููู ูโุดูุฏุ ุขุฎุฑู ููุฏุงุฑ ุฑุง ุจุฑุง (ุจู ุทูุฑ ูพุดโูุฑุถ) 5 ุฏููู ูุจู ุงุฒ ูุงูพุฏุฏ ุดุฏู ุญูุธ ูโฺฉููุฏ. ุชูุธู `track_timestamps_staleness` ูโุชูุงูุฏ ุงู ุฑุง ุชุบุฑ ุฏูุฏ.

**ุงุฌุชูุงุจ ุงุฒ `queries` ฺฉูุฏ ู `overloads`**
ุงฺฏุฑ ฺฉ `query` ูุงุฒ ุจู ุนููุงุช ุจุฑ ุฑู ููุฏุงุฑ ูุงุจู ุชูุฌู ุงุฒ ุฏุงุฏู ุฏุงุดุชู ุจุงุดุฏุ ุชุฑุณู `graph` ุขู ููฺฉู ุงุณุช ุจุง `timeout` ููุงุฌู ุดูุฏ ุง `server` ุง `browser` ุฑุง `overload` ฺฉูุฏ. ุจูุงุจุฑุงูุ ููฺฏุงู ุณุงุฎุช `queries` ุจุฑ ุฑู ุฏุงุฏูโูุง ูุงุดูุงุฎุชูุ ููุดู ุณุงุฎุช `query` ุฑุง ุฏุฑ ููุง `tabular view` `expression browser` `Prometheus` ุดุฑูุน ฺฉูุฏ ุชุง ุฒูุงู ฺฉู ูุฌููุนู ูุชุงุฌ ูุนููู ุจู ูุธุฑ ุจุฑุณุฏ (ุญุฏุงฺฉุซุฑ ุตุฏูุงุ ูู ูุฒุงุฑุงูุ `time series`). ููุท ุฒูุงู ฺฉู ุฏุงุฏูโูุง ุฎูุฏ ุฑุง ุจู ุงูุฏุงุฒู ฺฉุงู ููุชุฑ ุง `aggregate` ฺฉุฑุฏุฏุ ุจู ุญุงูุช `graph mode` ุจุฑูุฏ. ุงฺฏุฑ `expression` ูููุฒ ุจุฑุง ุชุฑุณู `graph` ุจู ุตูุฑุช `ad-hoc` ุจุด ุงุฒ ุญุฏ ุทูู ูโฺฉุดุฏุ ุขู ุฑุง ุงุฒ ุทุฑู ฺฉ `recording rule` ูพุดโุถุจุท ฺฉูุฏ.

ุงู ุจู ูฺู ุจุฑุง ุฒุจุงู `query` `Prometheus` ูุฑุชุจุท ุงุณุชุ ุฌุง ฺฉู ฺฉ `metric name selector` ุฎุงู ูุงููุฏ `api_http_requests_total` ูโุชูุงูุฏ ุจู ูุฒุงุฑุงู `time series` ุจุง `labels` ูุฎุชูู ฺฏุณุชุฑุด ุงุจุฏ. ููฺููุ ุจู ุฎุงุทุฑ ุฏุงุดุชู ุจุงุดุฏ ฺฉู `expressions` ฺฉู ุจุฑ ุฑู ุจุณุงุฑ ุงุฒ `time series`ูุง `aggregate` ูโุดููุฏุ ุญุช ุงฺฏุฑ ุฎุฑูุฌ ููุท ุชุนุฏุงุฏ ฺฉู `time series` ุจุงุดุฏุ ุฑู `server` ุจุงุฑ ุงุฌุงุฏ ูโฺฉููุฏ. ุงู ุดุจู ุจู ุงู ุงุณุช ฺฉู ฺฺฏููู ุฌูุน ฺฉุฑุฏู ุชูุงู ููุงุฏุฑ ฺฉ ุณุชูู ุฏุฑ ฺฉ `relational database` ฺฉูุฏ ุฎูุงูุฏ ุจูุฏุ ุญุช ุงฺฏุฑ ููุฏุงุฑ ุฎุฑูุฌ ููุท ฺฉ ุนุฏุฏ ุจุงุดุฏ.
